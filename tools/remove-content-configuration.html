

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Remove a Sphinx documentation project from production &mdash; Rackspace Documentation Guides  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  <link rel="stylesheet" href="../_static/bespoke.css" type="text/css" />
  <link rel="stylesheet" href="../_static/bolditalic.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Configure redirects" href="configure-redirects.html" />
    <link rel="prev" title="Creating a PDF file from RPC docs" href="RPC-PDF-creation.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Rackspace Documentation Guides
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../contributor-collateral/index.html">Contribute to Rackspace documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../style-guide/index.html">Style guide for technical content</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tools</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="publishing.html">Configure development and production builds for Sphinx projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="rpc-workflow.html">RPC workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="reno-notes.html">Reno release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="RPC-PDF-creation.html">Creating a PDF file from RPC docs</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Remove a Sphinx documentation project from production</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#housekeeping-tasks">Housekeeping tasks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#delete-content-from-nexus-content-store">Delete content from nexus content store</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configure-redirects.html">Configure redirects</a></li>
<li class="toctree-l2"><a class="reference internal" href="add-github-links-to-docs.html">Add GitHub links for contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="build-from-source.html">Build Sphinx doc projects locally</a></li>
<li class="toctree-l2"><a class="reference internal" href="mdsphinx.html">Markdown to RST table conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="rtd-tables.html">Table width fix for Read the Docs Sphinx theme</a></li>
<li class="toctree-l2"><a class="reference internal" href="table-conversion.html">Convert grid tables to list-table directives</a></li>
<li class="toctree-l2"><a class="reference internal" href="deconst-local.html">Setting up local deconst</a></li>
<li class="toctree-l2"><a class="reference internal" href="use-extlink-library.html">Linking to external resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="GitHub-infra-templates/index.html">GitHub Infra Templates</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../outreach/rack-blog-post-process.html">Rackspace blog processes and procedures</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Rackspace Documentation Guides</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Tools</a> &raquo;</li>
        
      <li>Remove a Sphinx documentation project from production</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tools/remove-content-configuration.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="remove-a-sphinx-documentation-project-from-production">
<h1>Remove a Sphinx documentation project from production<a class="headerlink" href="#remove-a-sphinx-documentation-project-from-production" title="Permalink to this headline">#</a></h1>
<p>To delete published content from the nexus, make the following
configuration changes to the landing page, nexus-control repository, and
the content store:</p>
<ol class="arabic">
<li><p class="first">Update the landing page index to delete the title from the html source.</p>
<p>If you are removing a category, remove any associated sections or headings.
For details, see the <a class="reference external" href="https://github.com/rackerlabs/docs-quickstart/blob/master/CONTRIBUTING.md">landing page contribution guidelines</a>.</p>
</li>
<li><p class="first">To prevent 404 errors from existing links and bookmarks, update
the <code class="docutils literal notranslate"><span class="pre">rewrites.json</span></code> file to add a
<a class="reference internal" href="configure-redirects.html#configure-redirects"><span class="std std-ref">redirect rule</span></a>.</p>
<ul class="simple">
<li>If the content has been moved to an external site, redirect the old
URL to the URL on the new site.</li>
<li>If the content is no longer available, redirect the old URL to a logical
reference point like the home page for the documentation collection.
If necessary, you can add a page or topic to explain the content removal
so that you can redirect links from the legacy content to the
explanation.</li>
</ul>
</li>
<li><p class="first"><a class="reference internal" href="#delete-nexus-content"><span class="std std-ref">Delete content</span></a> that has already been deployed
to <code class="docutils literal notranslate"><span class="pre">developer.rackspace.com</span></code>.</p>
</li>
</ol>
<div class="section" id="housekeeping-tasks">
<h2>Housekeeping tasks<a class="headerlink" href="#housekeeping-tasks" title="Permalink to this headline">#</a></h2>
<p>Update the nexus control configuration to remove references to obsolete
projects.</p>
<ol class="arabic">
<li><p class="first">Remove any project-specific entries from the nexus-control
<a class="reference external" href="https://github.com/rackerlabs/nexus-control/blob/master/config/content.d/developer.rackspace.com.json">content mapping</a> (<code class="docutils literal notranslate"><span class="pre">content.d</span></code>) and <a class="reference external" href="https://github.com/rackerlabs/nexus-control/blob/master/config/route.d/developer.rackspace.com.json">template</a> (<code class="docutils literal notranslate"><span class="pre">route.d</span></code>) JSON files.</p>
<p>You donâ€™t have to update these files if your project is configured in a
group unless you want to remove the whole group. For example, to
stop publishing all Rackspace Private Cloud v11 projects, delete
the content mapping for the v11 branch of the docs-rpc GitHub repository.
If you want to stop mapping private cloud content, remove the
<code class="docutils literal notranslate"><span class="pre">docs/private-cloud</span></code> entry from the template file.</p>
</li>
<li><p class="first">If you are removing an entire repository or branch within a repository,
edit the Strider build job inventory in the <code class="docutils literal notranslate"><span class="pre">content-repositories.json</span></code>
file to remove the GitHub repository or branch name.</p>
</li>
</ol>
<div class="section" id="delete-content-from-nexus-content-store">
<span id="delete-nexus-content"></span><h3>Delete content from nexus content store<a class="headerlink" href="#delete-content-from-nexus-content-store" title="Permalink to this headline">#</a></h3>
<p>Use these instructions to delete content that has been deployed to a production
site managed by the nexus control repository.</p>
<div class="section" id="prerequisites">
<h4>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li>You need an API key for the content service.</li>
<li>You canâ€™t be on the VPN (because it blocks port 9000).</li>
<li>Itâ€™s helpful to have some kind of JSON formatter for your browser like
the <a class="reference external" href="https://chrome.google.com/webstore/detail/json-formatter/bcjindcccaagfpapjjmafapmmgkkhgoa">Chrome JSON formatter</a>.</li>
<li>A <a class="reference external" href="http://meyerweb.com/eric/tools/dencoder/">URL encoder</a> of some kind. I personally use the
<a class="reference external" href="https://atom.io/packages/escape-utils">escape-utils Atom package</a>.</li>
</ul>
</div>
<div class="section" id="list-content">
<span id="id1"></span><h4>List content<a class="headerlink" href="#list-content" title="Permalink to this headline">#</a></h4>
<p>Before deleting content in production, itâ€™s a good idea to make sure you know
what youâ€™re about to delete. You can list the content IDs that are currently
present in Nexus by visiting the <a class="reference external" href="https://developer.rackspace.com:9000/content/](https://developer.rackspace.com:9000/content/&gt;">content endpoint</a>.</p>
<p>List content IDs that begin with a specific base by providing a URL-encoded
<code class="docutils literal notranslate"><span class="pre">?prefix=</span></code> parameter as shown in the following example:</p>
<div class="code console highlight-default notranslate"><div class="highlight"><pre><span></span>https://developer.rackspace.com:9000/content?prefix=https%3A%2F%2Fgithub.com%2Frackerlabs%2Fdocs-dedicated-vcloud&gt;`_
</pre></div>
</div>
<p>Results are returned 100 at a time. You can paginate (awkwardly) by adding
<code class="docutils literal notranslate"><span class="pre">&amp;pageNumber=2</span></code> to the end of the URL. The full documentation is in
<a class="reference external" href="https://github.com/deconst/content-service#get-contentprefixid_prefixpagenumbernumperpagesize">content service README</a>.</p>
</div>
<div class="section" id="delete-content">
<span id="id2"></span><h4>Delete content<a class="headerlink" href="#delete-content" title="Permalink to this headline">#</a></h4>
<p>Delete individual envelopes by submitting a cURL <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> request to the
content service API, using the URL-encoded content ID:</p>
<div class="code console highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">APIKEY</span><span class="o">=</span><span class="s2">&quot;...&quot;</span>

<span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">DELETE</span> \
     <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Authorization: deconst $</span><span class="si">{APIKEY}</span><span class="s2">&quot;</span> \
     <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">developer</span><span class="o">.</span><span class="n">rackspace</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="mi">9000</span><span class="o">/</span><span class="n">content</span><span class="o">/</span><span class="n">https</span><span class="o">%</span><span class="mi">3</span><span class="n">A</span><span class="o">%</span><span class="mi">2</span><span class="n">F</span><span class="o">%</span><span class="mi">2</span><span class="n">Fgithub</span><span class="o">.</span><span class="n">com</span><span class="o">%</span><span class="mi">2</span><span class="n">Frackerlabs</span><span class="o">%</span><span class="mi">2</span><span class="n">Fdocs</span><span class="o">-</span><span class="n">dedicated</span><span class="o">-</span><span class="n">vcloud</span>
</pre></div>
</div>
<p>(You can copy and paste the <code class="docutils literal notranslate"><span class="pre">/content/...</span></code> bit from the <code class="docutils literal notranslate"><span class="pre">url</span></code> key in the
search results in your browser.)</p>
<p>To bulk delete <em>all</em> envelopes beneath a content ID base that youâ€™ve removed or
renamed, specify the <code class="docutils literal notranslate"><span class="pre">?prefix=true</span></code> parameter:</p>
<div class="code console highlight-default notranslate"><div class="highlight"><pre><span></span>export APIKEY=&quot;...&quot;

curl -X DELETE \
     -H &quot;Authorization: deconst ${APIKEY}&quot; \
     https://developer.rackspace.com:9000/content/https%3A%2F%2Fgithub.com%2Frackerlabs%2Fdocs-dedicated-vcloud?prefix=true
</pre></div>
</div>
<p>The documentation for this endpoint is also in
<a class="reference external" href="https://github.com/deconst/content-service#delete-contentidprefixtrue">the content service README</a>.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="configure-redirects.html" class="btn btn-neutral float-right" title="Configure redirects" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="RPC-PDF-creation.html" class="btn btn-neutral" title="Creating a PDF file from RPC docs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Rackspace.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>